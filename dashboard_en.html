<!DOCTYPE html>
<html>
<head>
    <title>Journal Search - Scientific Search System</title>
    <link rel="stylesheet" href="./lib/choices/choices.min.css">
    <link rel="stylesheet" href="./style.css?v=2">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="header-branding">
                <img src="./logo.png" alt="Logo" class="header-logo">
                <h1 class="header-title">Medical Journals Dashboard</h1>
            </div>
            <nav class="main-nav">
                <div class="lang-selector">
                    <a href="dashboard.html"><img src="https://flagsapi.com/BR/shiny/24.png" alt="PortuguÃªs" class="lang-flag"></a>
                    <a href="dashboard_en.html"><img src="https://flagsapi.com/US/shiny/24.png" alt="English" class="lang-flag"></a>
                </div>
                <a href="portal_en.html" class="btn btn-secondary">Back</a>
            </nav>
        </div>
    </header>
    <div id="dashboard">
        <div id="journal-management">
            <div class="title-with-tooltip">
                <h2>Search Configuration</h2>
                <div class="tooltip">
                    <span class="tooltip-icon">?</span>
                    <div class="tooltip-text">
                        The search will have a maximum range of 500 results.<br><br>
                        The listed journals were selected by the site's author to allow specific searches in one or more publications. Requests or suggestions for new journals to be listed can be made to the author via the contact button in the footer.<br><br>
                        The search is carried out by the "E-Utilities" programmer tool provided by Pubmed, and does not include publications outside the database of the NLM organization (Maryland / USA).
                    </div>
                </div>
            </div>
            <label for="journal-selector">Select Journals:</label>
            <select id="journal-selector" multiple>
            </select>
            <br>

            <label for="start-date">Start Date:</label>
            <input type="date" id="start-date">

            <label for="end-date">End Date:</label>
            <input type="date" id="end-date">
            <br>

            <div class="date-buttons-group">
                <div class="recent-periods">
                    <button id="last-1-month">1 Month</button>
                    <button id="last-3-months">3 Months</button>
                    <button id="last-6-months">6 Months</button>
                    <button id="last-1-year">1 Year</button>
                </div>
                <div class="recent-periods">
                    <button id="last-15-months">15 Months</button>
                    <button id="last-18-months">18 Months</button>
                    <button id="last-21-months">21 Months</button>
                    <button id="last-2-years">2 Years</button>
                </div>
                <div class="year-ranges">
                    <button id="range-2022-2024">2022-2024</button>
                    <button id="range-2019-2021">2019-2021</button>
                    <button id="range-2016-2018">2016-2018</button>
                    <button id="range-2013-2015">2013-2015</button>
                    <button id="range-2010-2012">2010-2012</button>
                    <button id="range-2005-2009">2005-2009</button>
                    <button id="range-2000-2004">2000-2004</button>
                    <button id="range-1990-1999">1990-1999</button>
                    <button id="range-1980-1989">1980-1989</button>
                </div>
            </div>
            <br>

            <label for="author">Author:</label>
            <input type="text" id="author" placeholder="Author's name">
            <br>

            <label for="keywords">Keywords:</label>
            <input type="text" id="keywords" placeholder="Separate with commas">
            <br>

            <div class="checkbox-container">
                <label for="open-access-only" class="checkbox-label">Open Access articles only</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="open-access-only" name="open-access-only">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="button-group">
                <button id="search-button">Search</button>
                <button id="clear-search-button" style="background: linear-gradient(135deg, #e74c3c, #ec7063) !important;">Clear Parameters</button>
            </div>
        </div>
        
        <div id="search-results">
            <h2>Search Results</h2>
            <div id="loading" style="display: none;">
                <div class="loading-content">
                    <div class="loading-spinner"></div>
                    <div class="loading-message">
                        <span>Searching PubMed...</span>
                    </div>
                </div>
            </div>
            
            <div id="results-info" style="display: none;">
                <p><span>Total articles found:</span> <span id="total-count">0</span></p>
                <div id="search-summary" class="search-summary-class"></div>
            </div>
            
            <div id="table-controls" style="display: none;">
                <div class="filter-controls">
                    <input type="text" id="search-filter" placeholder="Filter results...">
                    <select id="column-filter">
                        <option value="">All columns</option>
                        <option value="TITULO DA PUBLICACAO">Title</option>
                        <option value="AUTORES">Authors</option>
                        <option value="REVISTA">Journal</option>
                        <option value="DATA DE PUBLICACAO">Date</option>
                        <option value="OPEN ACESS">Open Access</option>
                    </select>
                    <button id="clear-filters">Clear Filters</button>
                </div>
                
                <div class="export-controls">
                    <button id="export-html-button">Export HTML</button>
                    <button id="fullscreen-button">Fullscreen</button>
                </div>
            </div>
            
            <div id="message-container" class="message-container" style="display: none;"></div>
            <div id="table-container">
                <table id="results-table">
                    <thead>
                        <tr>
                            <th data-column="DATA DE PUBLICACAO" class="sortable col-date"><span>Date</span> <span class="sort-arrow"></span></th>
                            <th data-column="TITULO DA PUBLICACAO" class="sortable col-title"><span>Title</span> <span class="sort-arrow"></span></th>
                            <th data-column="REVISTA" class="sortable col-journal"><span>Journal</span> <span class="sort-arrow"></span></th>
                            <th data-column="AUTORES" class="sortable col-authors"><span>Authors</span> <span class="sort-arrow"></span></th>
                            <th data-column="LINK CANONICO" class="col-link"><span>Link</span></th>
                            <th data-column="OPEN ACESS" class="sortable col-access"><span>Open Access</span> <span class="sort-arrow"></span></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div id="pagination-container" class="pagination-container"></div>
        </div>
        <div id="custom-filters">
            <div class="title-with-tooltip">
                <h2 data-key="custom_filters_title">Custom Filters</h2>
                <div class="tooltip">
                    <span class="tooltip-icon">?</span>
                    <div class="tooltip-text" data-key="custom_filters_tooltip">
                        Here you can save your preferred search settings as Filters, which will be displayed as buttons in this section. You can create immediate access to specific journals and time intervals (e.g., Radiographics last month, last 3 months).<br><br>
                        Just click the "+" icon and add a new Filter that will be saved to your user account and can be deleted at any time! This will make it easier to follow journals you subscribe to, displaying them in an organized and summarized way on the dashboard. Enjoy!
                    </div>
                </div>
            </div>
            <div class="add-filter-container">
                <button id="add-filter-btn" class="add-filter-button" title="Add new filter">+</button>
            </div>
            <div id="saved-filters-container">
                <!-- Saved filters will be inserted here via JS -->
            </div>
        </div>
    </div>

    <!-- Filter Modal -->
    <div id="filter-modal" class="filter-modal-overlay">
        <div class="filter-modal-content">
            <div class="filter-modal-header">
                <h3>Create New Filter</h3>
                <button id="close-filter-modal" class="close-modal-button">&times;</button>
            </div>
            <div class="filter-modal-body">
                <div class="form-group">
                    <label for="filter-name">Filter Name:</label>
                    <input type="text" id="filter-name" placeholder="E.g., Radiographics Last Month">
                </div>
                <div class="form-group">
                    <label for="filter-journal-selector">Select Journals:</label>
                    <select id="filter-journal-selector" multiple></select>
                </div>
                <div class="form-group">
                    <label>Select Period:</label>
                    <div class="date-buttons-group modal-date-buttons">
                        <div class="recent-periods">
                            <button data-period="1m">1 Month</button>
                            <button data-period="3m">3 Months</button>
                            <button data-period="6m">6 Months</button>
                            <button data-period="12m">1 Year</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Or custom range:</label>
                    <div class="custom-date-range">
                        <input type="date" id="filter-start-date">
                        <span>to</span>
                        <input type="date" id="filter-end-date">
                    </div>
                </div>
            </div>
            <div class="filter-modal-footer">
                <button id="save-filter-button" class="btn btn-primary">Save Filter</button>
            </div>
        </div>
    </div>

    <footer class="main-footer-credits">
        <p>
            <span class="footer-icon">ðŸ”¬</span><span>Website developed by radiologist JoÃ£o Victor Pruner Vieira (CRM/PR 30289). All rights reserved.</span>
            <span class="email-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
            </span>
        </p>
        <div id="visitor-counter">
            <img src="https://api.visitorbadge.io/api/visitors?path=https%3A%2F%2Fjoaovictorpv.github.io%2FDashboard%2Fexperimento%2F&label=Visitors&countColor=%2364FFDA&style=flat" alt="Visitor Counter"/>
        </div>
    </footer>

    <!-- Fullscreen Modal -->
    <div id="modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <button id="modal-close-button" class="modal-close-button">&times;</button>
            <div id="modal-table-container">
                <!-- The table will be rendered here via JS -->
            </div>
        </div>
    </div>

    <!-- Contact Form Pop-up -->
    <div id="contact-popup">
        <div class="popup-header">
            <h3>Contact</h3>
            <button class="close-popup">&times;</button>
        </div>
        <form class="popup-form" action="https://formspree.io/f/mgvnonzo" method="POST">
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="subject">Subject</label>
                <input type="text" id="subject" name="subject" required>
            </div>
            <div class="form-group">
                <label for="message">Comments</label>
                <textarea id="message" name="message" required></textarea>
            </div>
            <button type="submit">Submit</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const emailIcon = document.querySelector('.email-icon');
            const contactPopup = document.getElementById('contact-popup');
            const closePopupButton = document.querySelector('.close-popup');

            if (emailIcon && contactPopup && closePopupButton) {
                emailIcon.addEventListener('click', function(event) {
                    event.stopPropagation();
                    contactPopup.classList.add('show');
                });

                closePopupButton.addEventListener('click', function() {
                    contactPopup.classList.remove('show');
                });

                // Close pop-up if clicking outside of it
                document.addEventListener('click', function(event) {
                    if (contactPopup.classList.contains('show') && !contactPopup.contains(event.target) && !emailIcon.contains(event.target)) {
                        contactPopup.classList.remove('show');
                    }
                });
            }
        });
    </script>

<script src="./lib/choices/choices.min.js"></script>
<script src="./dashboard.js?v=2"></script>
</body>
</html>
